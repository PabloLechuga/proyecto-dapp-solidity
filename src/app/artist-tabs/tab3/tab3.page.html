<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-title>
      Mi Perfil
    </ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="refreshData()" [disabled]="isLoading">
        <ion-icon slot="icon-only" name="refresh"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <ion-header collapse="condense">
    <ion-toolbar>
      <ion-title size="large">Mi Perfil</ion-title>
    </ion-toolbar>
  </ion-header>

  <div *ngIf="isLoading" class="loading-container">
    <ion-spinner name="crescent"></ion-spinner>
    <p>Cargando información...</p>
  </div>

  <ion-card *ngIf="message" [color]="messageColor">
    <ion-card-content>
      {{ message }}
    </ion-card-content>
  </ion-card>

  <ion-card *ngIf="!isLoading && walletAddress">
    <ion-card-header>
      <ion-card-title>
        <ion-icon name="person-circle" style="font-size: 2rem; vertical-align: middle;"></ion-icon>
        {{ profile.role }}
      </ion-card-title>
      <ion-card-subtitle>Perfil de {{ profile.role }}</ion-card-subtitle>
    </ion-card-header>

    <ion-card-content>
      <ion-list>
        <ion-item>
          <ion-icon name="wallet" slot="start"></ion-icon>
          <ion-label>
            <h3>Dirección Wallet</h3>
            <p>{{ formatAddress(profile.walletAddress) }}</p>
          </ion-label>
          <ion-button fill="clear" slot="end" (click)="copyAddress()">
            <ion-icon slot="icon-only" name="copy"></ion-icon>
          </ion-button>
        </ion-item>

        <ion-item>
          <ion-icon name="cash" slot="start" color="success"></ion-icon>
          <ion-label>
            <h3>Balance</h3>
            <p>{{ profile.balance }} ETH</p>
          </ion-label>
        </ion-item>

        <ion-item>
          <ion-icon name="ticket" slot="start" color="primary"></ion-icon>
          <ion-label>
            <h3>Entradas Creadas</h3>
            <p>{{ profile.totalNFTsCreated }} NFTs emitidos</p>
          </ion-label>
        </ion-item>

        <ion-item>
          <ion-icon name="albums" slot="start" color="secondary"></ion-icon>
          <ion-label>
            <h3>En tu Cartera</h3>
            <p>{{ myNFTs.length }} entradas</p>
          </ion-label>
        </ion-item>
      </ion-list>
    </ion-card-content>
  </ion-card>

  <ion-card *ngIf="!isLoading && myNFTs.length > 0">
    <ion-card-header>
      <ion-card-title>Mis Entradas</ion-card-title>
      <ion-card-subtitle>{{ myNFTs.length }} entradas en tu cartera</ion-card-subtitle>
    </ion-card-header>

    <ion-card-content>
      <ion-list>
        <ion-item *ngFor="let nft of myNFTs" [button]="false">
          <ion-icon name="musical-notes" slot="start" color="primary"></ion-icon>
          <ion-label>
            <h3>{{ nft.name }}</h3>
            <p>Token ID: #{{ nft.tokenId }}</p>
            <ion-note>{{ nft.uri }}</ion-note>
          </ion-label>
          <ion-badge slot="end" [color]="nft.isListed ? 'success' : 'medium'">
            {{ nft.isListed ? 'En venta' : 'En cartera' }}
          </ion-badge>
        </ion-item>
      </ion-list>
    </ion-card-content>
  </ion-card>

  <ion-card *ngIf="!isLoading && myNFTs.length === 0 && walletAddress">
    <ion-card-content class="empty-state">
      <ion-icon name="ticket-outline" style="font-size: 4rem; opacity: 0.3;"></ion-icon>
      <h3>No tienes entradas</h3>
      <p>Las entradas que crees aparecerán aquí</p>
      <ion-button routerLink="/artist-tabs/tab2" expand="block">
        Crear Evento
      </ion-button>
    </ion-card-content>
  </ion-card>

  <ion-card *ngIf="!isLoading && !walletAddress">
    <ion-card-content class="empty-state">
      <ion-icon name="wallet-outline" style="font-size: 4rem; opacity: 0.3;"></ion-icon>
      <h3>Wallet no conectada</h3>
      <p>Por favor conecta tu wallet para ver tu perfil</p>
      <ion-button routerLink="/login-tabs/tab1" expand="block">
        Ir a Login
      </ion-button>
    </ion-card-content>
  </ion-card>

</ion-content>
